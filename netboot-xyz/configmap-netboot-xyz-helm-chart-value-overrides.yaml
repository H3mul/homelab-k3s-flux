apiVersion: v1
kind: ConfigMap
metadata:
  creationTimestamp: null
  name: netboot-xyz-helm-chart-value-overrides
  namespace: netboot-xyz
data:
  values.yaml: |-
    image:
      repository: linuxserver/netbootxyz
      tag: 0.6.7

    env:
      TZ: "${TIMEZONE}"
      # PORT_RANGE: 30000:30005

    service:
      main:
        ports:
          http:
            port: 3000
      tftp:
        enabled: true
        type: LoadBalancer
        annotations:
          external-dns.alpha.kubernetes.io/hostname: netboot-tftp.${CLUSTER_DOMAIN}
        externalTrafficPolicy: Local
        ports:
          tftp:
            enabled: true
            port: 69
            protocol: UDP
          data0:
            enabled: true
            port: 30000
            protocol: UDP
          data1:
            enabled: true
            port: 30001
            protocol: UDP
          data2:
            enabled: true
            port: 30002
            protocol: UDP
          data3:
            enabled: true
            port: 30003
            protocol: UDP
          data4:
            enabled: true
            port: 30004
            protocol: UDP
          data5:
            enabled: true
            port: 30005
            protocol: UDP
          data6:
            enabled: true
            port: 30006
            protocol: UDP
          data7:
            enabled: true
            port: 30007
            protocol: UDP
          data8:
            enabled: true
            port: 30008
            protocol: UDP
          data9:
            enabled: true
            port: 30009
            protocol: UDP
          data10:
            enabled: true
            port: 30010
            protocol: UDP

    ingress:
      main:
        enabled: true
        ingressClassName: traefik
        hosts:
        - host: &host "netboot.${CLUSTER_DOMAIN}"
          paths:
          - path: /
            pathType: Prefix
        tls:
        - secretName: letsencrypt-wildcard-cert-prod
          hosts:
          - *host

    persistence:
      config:
        enabled: true
        mountPath: /config
        type: pvc
        size: 200Mi
        accessMode: ReadWriteOnce
        storageClass: ceph-block

      assets:
        enabled: true
        mountPath: /assets
        type: pvc
        size: 10Gi
        accessMode: ReadWriteOnce
        storageClass: ceph-block
